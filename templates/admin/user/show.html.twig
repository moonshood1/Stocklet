{% extends 'admin/base.html.twig' %}

{% block title %}Profil de {{ user.firstName }} {% endblock %}

{% block body %}
<div class="content-container">
    <div class="container-fluid">
            {{ wo_render_breadcrumbs({separator: '>>'}) }}
      <div class="row">
        <div class="col-md-4">
          <div class="card mt-1" style="width: 18rem">
            <img
              class="avatar-admin mt-2"
              {% if user.picture is null and user.pictureName is null %}
                src="https://via.placeholder.com/150C"
                {% elseif user.picture is null %}
                src="/images/avatar/{{ user.pictureName }}"
                {% else %}
                  src="{{ user.picture }}"
              {% endif %}     
              alt="Card image cap"/>
            <div class="card-body">
              <h5 class="card-title text-center">{{ user.firstName }} {{ user.lastName }} </h5>
              <p class="card-text text-center text-muted">
                <small> membre depuis le {% if user.registeredAt %}
                  {{ user.registeredAt|date('d/m/Y')}}
                {% else %}
                    (Date non enregistrée)
                  {% endif %}</small>
              </p>
              <hr />
              <div class="row">
                <div class="col-sm-6">
                  <p class="text-center"><strong>{{ user.orders|length }}</strong></p>
                  <p class="text-center">Commandes</p>
                </div>
                <div class="col-sm-6">
                  <p class="text-center"><strong>{{ user.comments|length }}</strong></p>
                  <p class="text-center">Commentaires</p>
                </div>
              </div>
                {% if user is same as(app.user)  %}
                    <a href="{{ path('admin_account_profile') }}" class="link">Modifier le profil</a><br />
                    <a href="{{ path('admin_account_password') }}" class="link">Modifier le mot de passe</a>
                {% endif %}
            </div>
          </div>
          <div class="card mt-2" style="width: 18rem">
            <div class="card-body">
              <h5 class="card-title">Infos supplémentaires</h5>
              <hr />
              <p class="card-text">
                <i class="fas fa-at"></i> {{ user.email }}
              </p>
              <p class="card-text">
                <i class="fas fa-mobile-alt"></i> +225 {{ user.userPhone }}
              </p>
              <p class="card-text">
                <i class="fas fa-map-marker-alt"></i> {{ user.address }}
              </p>
            </div>
          </div>
          <div class="card mt-2" style="width: 18rem">
            <div class="card-body">
              <h5 class="card-title">Activité sur Stocklet</h5>
              <hr />
              <div class="row">
                <div class="col-sm-12">
                  <p class=""><strong>{{ total|number_format(0,'','  ')  }} FCFA </strong></p>
                  <p class=""> de commandes </p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-8">
          <div class="card mt-1">
            <h5 class="card-header">Historiques des commandes</h5>
            <div class="card-body">
              {% if user.orders|length > 0 %}
                <table class="table table-hover">
                    <thead class="thead-dark">
                    <th scope="col">Date de commande</th>
                    <th scope="col">Nom du produit</th>
                    <th scope="col">Prix</th>
                    <th scope="col">Quantité cmdée</th>
                    <th scope="col">Total</th>
                    <th scope="col" class="text-center">Actions</th>
                    </thead>
                    {% for order in user.orders %}
                        <tbody>
                        <td>{{ order.orderDate|date('d/m/Y') }}</td>
                        <td>{{ order.products.productName }}</td>
                        <td>{{ order.productUnitPrice }}</td>
                        <td>{{ order.productQuantity }}</td>
                        <td>{{ order.orderTotalAmount|number_format(0,'','  ') }} FCFA </td>
                        <td class="text-center">
                            <a href="{{ path('admin_order_show', {'id': order.id }) }}" class="btn btn-primary"><i class="fas fa-eye"></i></a>
                        </td>
                        </tbody>                   
                    {% endfor %}
                </table>
                {% else %}
                    <div class="alert alert-warning">
                        <p>Aucune commandes sur le site pour le moments</p>
                    </div>
              {% endif %}
            </div>
            <nav aria-label="Page navigation example" class="ml-4">
              <ul class="pagination">
                <li class="page-item">
                  <a class="page-link" href="#">Precedent</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">1</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">2</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">3</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">Suivant</a>
                </li>
              </ul>
            </nav>
          </div>
          <div class="card mt-5">
            <h5 class="card-header">Les commentaires</h5>
            <div class="card-body">
              <table class="table table-hover">
                <thead class="thead-dark">
                  <th scope="col">Date de publication</th>
                  <th scope="col">Commentaire</th>
                  <th scope="col">Reactions</th>
                  <th scope="col">Nom du produit</th>
                </thead>
                {% for comment in user.comments %}
                    <tbody>
                    <td>{{ comment.createdAt|date('d/m/Y - H:i') }}</td>
                    <td>{{ comment.content|raw }}</td>
                    <td>
                        <i class="fas fa-frown"></i> {{ comment.dislikes|length }}
                        <i class="fas fa-heart"></i> {{ comment.likes|length }}
                        <i class="fas fa-comments"></i> 4
                    </td>
                    <td>{{ comment.product.productName }}</td>
                    </tbody>               
                {% endfor %}
              </table>
              <div class="d-flex justify-content-center">
                <nav aria-label="Page navigation example" class="ml-4">
                  <ul class="pagination">
                    <li class="page-item">
                      <a class="page-link" href="#">Precedent</a>
                    </li>
                    <li class="page-item">
                      <a class="page-link" href="#">1</a>
                    </li>
                    <li class="page-item">
                      <a class="page-link" href="#">2</a>
                    </li>
                    <li class="page-item">
                      <a class="page-link" href="#">Suivant</a>
                    </li>
                  </ul>
                </nav>              
              </div>
            </div>
          </div>
        </div>
      </div>        
    </div>
</div>        
{% endblock %}