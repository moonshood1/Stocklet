{% extends 'admin/base.html.twig' %}

{% block title %}Profil de {{user.firstName}} {% endblock %}

{% block body %}
        <div class="content-container">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col-3 text-center">
                        <img 
                        {% if user.picture is null and user.pictureName is null %}
                            src="https://via.placeholder.com/150C"
                        {% elseif user.picture is null %}
                            src="/images/avatar/{{user.pictureName}}"
                        {% else %}
                            src="{{ user.picture }}"
                         {% endif %}
                        class = "avatar mb-3" alt="Avatar de {{ user.firstName }}">
                        <br>
                        <span class="badge badge-primary">{{user.orders|length }} commandes(s) </span>
                    </div>
                    <div class="col-9">
                        <h1>{{ user.firstName }} {{user.lastName}}</h1>
                        {% if user is same as(app.user) %}
                        <div class="mt-3">
                            <a href="{{ path('admin_account_profile') }}" class="btn btn-primary mr-2 mb-2">Modifier mes informations</a>
                            <a href="{{ path('admin_account_password') }}" class="btn btn-primary mb-2">Modifier mon mot de passe</a>
                        </div>
                        {% endif %}
                    </div>
                </div>
                <hr>
                <h2>Historiques des commandes </h2>
                {% if user.orders | length  > 0 %}
                    <div class="row">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Date de commande</th>
                                        <th>Produit</th>
                                        <th class="text-center">Quantité cmdée</th>
                                        <th class="text-center">Prix Unitaire</th>
                                        <th class="text-center">Montant</th>
                                        <th class="text-center">Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for order in user.orders %}
                                        <tr>
                                            <td>{{order.orderDate | date("d/m/Y") }}</td>
                                            <td>{{order.products.productName}} </td>
                                            <td class="text-center">{{ order.productQuantity }}</td>
                                            <td class="text-center">{{ order.productUnitPrice }}</td>
                                            <td class="text-center"> {{ order.OrderTotalAmount }}</td>
                                            <td class="text-center"><a href="{{ path('admin_order_show', {'id': order.id }) }}" class="btn btn-primary"><i class="fas fa-eye"></i></a></td>
                                        </tr>
                                    {% endfor  %}
                                </tbody>
                            </table>
                    </div>           
                {% else %}
                    <div class="alert alert-warning">
                        <p>
                            <strong> {{ user.firstName }}  </strong>n'a pas encore de commandes sur le site !
                        </p>
                    </div>
                {% endif %}
            </div>
        </div>
{% endblock %}